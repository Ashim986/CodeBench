---
phase: 01-foundation-bug-fixes
plan: 04
type: execute
wave: 2
depends_on: [01-01, 01-02]
files_modified:
  - CodeBench/CodeBench/DataJourney/Views/DataJourneySequenceBubbleRow.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneySequenceBubbleRow+Layout.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneyStringSequenceView.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneyDictionaryStructureRow.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneyTraceValueView.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneyVariableTimeline.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneyVariableTimeline+Rendering.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneyView.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneyView+Layout.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneyView+Playback.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneyView+Selection.swift
  - CodeBench/CodeBench/DataJourney/Views/DataJourneyView+Interaction.swift
autonomous: true
requirements: [REQ-F01, REQ-F02]

must_haves:
  truths:
    - "Sequence, string, dictionary, timeline, and main DataJourney views use `import LeetPulseDesignSystem` and reference DS tokens"
    - "No hardcoded Color literals remain in the 12 files touched by this plan"
    - "No hardcoded Font literals (.system(size:), .caption, .footnote) remain -- DS typography or VizTypography used"
    - "Light and dark theme both work through DS theme tokens in these views"
    - "All 14 renderers audited for remaining UUID/layout/hardcoded issues (combined with Plan 03)"
  artifacts:
    - path: "CodeBench/CodeBench/DataJourney/Views/DataJourneySequenceBubbleRow.swift"
      provides: "Array/sequence renderer using DS tokens"
      contains: "import LeetPulseDesignSystem"
    - path: "CodeBench/CodeBench/DataJourney/Views/DataJourneyView.swift"
      provides: "Main container view using DS tokens"
      contains: "import LeetPulseDesignSystem"
  key_links:
    - from: "@Environment(\\.dsTheme) var theme"
      to: "theme.colors.*, theme.vizColors.*, theme.typography.*"
      via: "SwiftUI environment injection from LeetPulseDesignSystem"
      pattern: "theme\\.(colors|vizColors|typography)"
---

<objective>
Replace all hardcoded styling in sequence, string, dictionary, timeline, and main DataJourney views with LeetPulseDesignSystem tokens.

Purpose: Second half of the "full sweep" -- migrate the remaining 12 visualization view files to DS tokens. Combined with Plan 03, this completes the full DS token migration across all 27 visualization view files.
Output: 12 visualization view files use DS tokens. Zero hardcoded color/font/size values across all visualization code.
</objective>

<execution_context>
@/Users/ashimdahal/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ashimdahal/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-bug-fixes/01-RESEARCH.md
@.planning/phases/01-foundation-bug-fixes/01-01-SUMMARY.md
@.planning/phases/01-foundation-bug-fixes/01-02-SUMMARY.md
@.planning/phases/01-foundation-bug-fixes/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace hardcoded styling in sequence, string, dictionary, timeline, and main DataJourney views</name>
  <files>
    CodeBench/CodeBench/DataJourney/Views/DataJourneySequenceBubbleRow.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneySequenceBubbleRow+Layout.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneyStringSequenceView.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneyDictionaryStructureRow.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneyTraceValueView.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneyVariableTimeline.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneyVariableTimeline+Rendering.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneyView.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneyView+Layout.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneyView+Playback.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneyView+Selection.swift,
    CodeBench/CodeBench/DataJourney/Views/DataJourneyView+Interaction.swift
  </files>
  <action>
Apply the same DS token replacement pattern from Plan 03 to the remaining visualization files:

1. Add `import LeetPulseDesignSystem` to each file.
2. Add `@Environment(\.dsTheme) var theme` to each View struct.
3. Replace all hardcoded Color, Font, and spacing values using the same mapping from Plan 03.

**Color replacements (same mapping as Plan 03):**
- `Color.red`, `.red` -> `theme.colors.danger`
- `Color.green`, `.green` -> `theme.colors.success`
- `Color.blue`, `.blue` -> `theme.colors.primary`
- `Color.yellow`, `.yellow`, `Color.orange` -> `theme.colors.warning`
- `Color.gray`, `.gray`, `Color.secondary` -> `theme.colors.textSecondary`
- `Color.white` -> `theme.colors.surface` or `theme.colors.foregroundOnViz`
- `Color.black` -> `theme.colors.textPrimary`
- `Color.clear` -> keep as `Color.clear` (transparent is universal)
- `Color(.systemBackground)` -> `theme.colors.background`

**Specific attention areas:**

- **DataJourneySequenceBubbleRow.swift**: Array element colors, index labels, pointer badge colors. Use `theme.vizColors.*` for categorical element coloring.

- **DataJourneyStringSequenceView.swift**: Character cell colors, highlight colors for matched/unmatched characters.

- **DataJourneyDictionaryStructureRow.swift**: Key-value pair styling, separator colors.

- **DataJourneyTraceValueView.swift**: Value display colors for different TraceValue types (numbers, strings, booleans, nulls).

- **DataJourneyVariableTimeline.swift + Rendering**: Event timeline colors, selection highlights, step indicators. Use `theme.colors.primary` for selection, `theme.colors.surfaceElevated` for timeline background.

- **DataJourneyView.swift + extensions**: Main container colors, section backgrounds, divider colors.

- **DataJourneyView+Playback.swift**: Playback control button colors, progress indicator, step counter text.

4. After completing all files, run a comprehensive grep to confirm zero hardcoded styling remains across ALL visualization code (both Plan 03 and Plan 04 files):
   ```bash
   grep -rn "Color\.\(red\|green\|blue\|yellow\|orange\|gray\|white\|black\)" CodeBench/CodeBench/DataJourney/Views/
   grep -rn "\.system(size:" CodeBench/CodeBench/DataJourney/Views/
   ```
   Expected: Zero matches (except VizTypography.swift which is intentionally kept, and Color.clear which is universal).

5. While in each file, audit for any remaining issues beyond styling and note them. Do not fix non-styling issues in this plan.

Per user decision: "ALL visualization styling (colors, typography, spacing) must come from the design system -- no hardcoded values."
Exception: VizTypography.swift is kept per research recommendation as a CodeBench-specific extension for dense visualization text sizes.
  </action>
  <verify>
1. `grep -rn "import LeetPulseDesignSystem" CodeBench/CodeBench/DataJourney/Views/` returns matches in ALL view files (27 files total, minus VizTypography.swift which is a constants file)
2. `grep -rn "Color\.\(red\|green\|blue\|yellow\|orange\|gray\|white\|black\)" CodeBench/CodeBench/DataJourney/Views/ | grep -v "VizTypography\|Color\.clear"` returns zero results
3. `grep -rn "\.system(size:" CodeBench/CodeBench/DataJourney/Views/ | grep -v "VizTypography"` returns zero results
4. `grep -rn "dsTheme" CodeBench/CodeBench/DataJourney/Views/DataJourneyView.swift` confirms theme environment variable present
  </verify>
  <done>All remaining visualization view files use DS tokens. Zero hardcoded Color/Font/size literals remain across ALL visualization code (except VizTypography.swift for dense viz text and Color.clear). Both light and dark themes work through DS tokens. Full audit of all 14 renderers completed (combined with Plan 03).</done>
</task>

</tasks>

<verification>
1. All 27 visualization view files have `import LeetPulseDesignSystem` (combined Plan 03 + Plan 04)
2. `grep -rn "Color\.\(red\|green\|blue\|yellow\|orange\|gray\|white\|black\)" CodeBench/CodeBench/DataJourney/Views/ | grep -v VizTypography | grep -v Color.clear` returns zero results
3. `grep -rn "\.system(size:" CodeBench/CodeBench/DataJourney/Views/ | grep -v VizTypography` returns zero results
4. Categorical visualization uses Okabe-Ito palette from DS vizColors
5. Xcode project builds without errors
</verification>

<success_criteria>
- All 12 files import LeetPulseDesignSystem and use @Environment(\.dsTheme)
- Zero hardcoded Color/Font literals across ALL visualization code (except VizTypography and Color.clear)
- Combined with Plan 03, the full DS token sweep is complete
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-bug-fixes/01-04-SUMMARY.md`
</output>
