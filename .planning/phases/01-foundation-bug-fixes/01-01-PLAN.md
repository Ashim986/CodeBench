---
phase: 01-foundation-bug-fixes
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - CodeBench/project.yml
  - CodeBench/CodeBench/DataJourney/DesignTokens.swift
  - TestCaseEvaluator/CodeBench/
autonomous: true
requirements: []  # Infrastructure-only: sets up DS dependency and cleans code ownership. REQ-F01/F02 directly implemented by Plans 02-05.

must_haves:
  truths:
    - "LeetPulseDesignSystem is available as an import in CodeBench target"
    - "Local DesignTokens.swift no longer exists -- no duplicate symbol conflicts"
    - "TestCaseEvaluator builds and all tests pass without the CodeBench duplicate"
    - "TestCaseEvaluator/CodeBench/ directory no longer exists"
  artifacts:
    - path: "CodeBench/project.yml"
      provides: "SPM local package dependency on LeetPulseDesignSystem"
      contains: "LeetPulseDesignSystem"
  key_links:
    - from: "CodeBench/project.yml"
      to: "/Users/ashimdahal/Documents/LeetPulseDesignSystem"
      via: "SPM local package dependency path"
      pattern: "LeetPulseDesignSystem"
---

<objective>
Add LeetPulseDesignSystem as a local SPM dependency, delete the local DesignTokens.swift shim, and remove the duplicate DataJourney codebase from TestCaseEvaluator.

Purpose: Establish the design system as single source of styling truth and clean up code ownership (CodeBench owns visualization, TestCaseEvaluator owns data). This unblocks the DS token sweep in Plan 03.
Output: CodeBench project configured with LeetPulseDesignSystem dependency, local shim deleted, duplicate removed.
</objective>

<execution_context>
@/Users/ashimdahal/.claude/get-shit-done/workflows/execute-plan.md
@/Users/ashimdahal/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation-bug-fixes/01-RESEARCH.md
@CodeBench/project.yml
@CodeBench/CodeBench/DataJourney/DesignTokens.swift
@TestCaseEvaluator/CodeBench/Package.swift
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add LeetPulseDesignSystem SPM dependency and delete local DesignTokens.swift</name>
  <files>CodeBench/project.yml, CodeBench/CodeBench/DataJourney/DesignTokens.swift</files>
  <action>
1. Read `CodeBench/project.yml` to understand the current XcodeGen configuration structure.

2. Add LeetPulseDesignSystem as a local SPM package dependency in project.yml:
   - Under `packages:` (create section if absent), add:
     ```yaml
     LeetPulseDesignSystem:
       path: ../LeetPulseDesignSystem
     ```
   - Under the CodeBench target's `dependencies:` array, add:
     ```yaml
     - package: LeetPulseDesignSystem
       product: LeetPulseDesignSystemCore
     ```
   The local path `../LeetPulseDesignSystem` resolves from CodeBench/ to `/Users/ashimdahal/Documents/LeetPulseDesignSystem`.

3. Delete `CodeBench/CodeBench/DataJourney/DesignTokens.swift` entirely. This file defines a local `DSTheme` struct that conflicts with the package's `DSTheme`. The package exports the identical environment key `\.dsTheme`, so all existing `@Environment(\.dsTheme) var theme` usage continues to work.

4. Do NOT add `import LeetPulseDesignSystem` to view files yet -- that is Plan 03's job. This task only sets up the dependency and removes the conflicting shim.

5. Regenerate the Xcode project from project.yml:
   ```bash
   cd CodeBench && xcodegen generate
   ```
   If xcodegen is not installed, note this for manual project update. The critical deliverable is the project.yml change.

IMPORTANT: The environment key `\.dsTheme` is identical in both local DesignTokens.swift and LeetPulseDesignSystem. The deletion MUST happen in the same change as the dependency addition to avoid either (a) duplicate symbols or (b) missing symbols.

Per user decision: Use local path SPM dependency (not git URL) since repos are co-located at /Users/ashimdahal/Documents/.
  </action>
  <verify>
1. `grep -r "LeetPulseDesignSystem" CodeBench/project.yml` returns the package entry
2. `test ! -f CodeBench/CodeBench/DataJourney/DesignTokens.swift` confirms deletion
3. `xcodegen generate` (if available) succeeds without errors
4. `grep -r "dsTheme" CodeBench/CodeBench/DataJourney/` still finds @Environment usage in view files (they reference the key but compilation will resolve to the package now)
  </verify>
  <done>LeetPulseDesignSystem is declared as a local SPM dependency in project.yml. DesignTokens.swift is deleted. No duplicate DSTheme symbols exist.</done>
</task>

<task type="auto">
  <name>Task 2: Remove duplicate DataJourney codebase from TestCaseEvaluator</name>
  <files>TestCaseEvaluator/CodeBench/</files>
  <action>
1. Read `TestCaseEvaluator/CodeBench/Package.swift` to confirm it is a standalone package with no reverse dependencies from TestCaseEvaluator's main Package.swift.

2. Verify no imports: `grep -r "import CodeBench" TestCaseEvaluator/Sources/ TestCaseEvaluator/Tests/` -- should return nothing. If it does return matches, those imports must be removed first.

3. Delete the entire `TestCaseEvaluator/CodeBench/` directory (contains Package.swift, Sources/CodeBench/ with ~47 duplicate Swift files, .build/, .swiftpm/). This is a separate SPM package within the TestCaseEvaluator directory that duplicates CodeBench's visualization code.

4. Verify TestCaseEvaluator still builds:
   ```bash
   cd TestCaseEvaluator && swift build 2>&1 | tail -5
   ```
   Expected: Build succeeds. The main TestCaseEvaluator/Package.swift has NO dependency on the CodeBench sub-package.

Per user decision: CodeBench owns all visualization/display code, TestCaseEvaluator owns all data production. Git history preserves everything.
  </action>
  <verify>
1. `test ! -d TestCaseEvaluator/CodeBench` confirms directory removed
2. `cd TestCaseEvaluator && swift build` succeeds
3. `grep -r "import CodeBench" TestCaseEvaluator/` returns nothing
  </verify>
  <done>TestCaseEvaluator/CodeBench/ directory is fully removed. TestCaseEvaluator builds and all tests pass without it. Code ownership is clean: CodeBench owns visualization, TestCaseEvaluator owns data.</done>
</task>

</tasks>

<verification>
1. LeetPulseDesignSystem dependency declared in project.yml with local path
2. DesignTokens.swift deleted from CodeBench
3. TestCaseEvaluator/CodeBench/ directory deleted
4. TestCaseEvaluator builds successfully (`swift build`)
5. No duplicate DSTheme symbols exist in the project
</verification>

<success_criteria>
- project.yml contains LeetPulseDesignSystem local package dependency
- DesignTokens.swift no longer exists
- TestCaseEvaluator/CodeBench/ no longer exists
- TestCaseEvaluator `swift build` succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-bug-fixes/01-01-SUMMARY.md`
</output>
